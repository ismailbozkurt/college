\section{Explotando el algoritmo ptmalloc}

Tal y como se ha explicado en el apartado \ref{sec:heap_theory_introduccion}, la gestión de memoria dinámica utilizada en sistemas GNU/Linux está implementada por el algoritmo llamado \textit{ptmalloc} desarrollador por Wolfram Gloger, que es una evolución de una implementación anterior llamada \textit{dlmalloc} desarrollada por Doug Lea. \\
Actualmente, la gestión de memoria dinámica implementada en la librería \textit{glibc} está basada en el algoritmo \textit{ptmalloc}, sin embargo, la implementación en la \textit{glibc} contiene ciertas modificaciones que, en la mayoría de los casos, están enfocadas a realizar una gestión de memoria de un modo más seguro. \bigskip

Debido a esto, en este apartado se detallará cómo explotar el algoritmo original sin las mejoras añadidas en la \textit{glibc}. De este modo se podrá detallar el proceso a seguir a un nivel básico de modo que el lector pueda desarrollar unos buenos fundamentos con los que proseguir con el estudio de la explotación del heap en cualquier arquitectura diferente a la tratada en esta investigación. \bigskip

Cabe destacar que aunque no se estudie la implementación del algoritmo de la \textit{glibc}, no se han encontrado investigaciones que detallen cómo explotar el algoritmo \textit{ptmalloc}. Todas las referencias bibliográficas sobre el tema han sido de excepcional ayuda, sin embargo, ninguna de ellas permite, a partir los detalles proporcionados, la ejecución de código arbitrario mediante la explotación del algoritmo. \\
Debido a la evolución del algoritmo, las técnicas retratadas en dichas investigaciones han quedado obsoletas mientras que lo que se detalla en esta investigación permite la ejecución de código arbitrario siguiendo vectores de ataque diferentes a los expuestos en dichas investigaciones.\bigskip

Lo primero que se debe realizar para continuar es descargar la implementación original del algoritmo \textit{ptmalloc} para que los códigos que se desarrollaran a continuación utilicen sus funciones en vez de utilizar las funciones que vienen implementadas en la \textit{glibc}. Todo este proceso está detallado en el Apéndice \ref{ap:I}.\\
De ahora en adelante y hasta que se especifique lo contrario, todos los códigos y numeración de líneas del código fuente están en referencia al código fuente del algoritmo original \textit{ptmalloc}, el especificado en el Apéndice \ref{ap:I}.

\pagebreak

\input{./Chapters/HeapExploiting/Unlink/unlink_macro_theory.tex}

\pagebreak

\input{./Chapters/HeapExploiting/Unlink/attack_vector.tex}

\pagebreak

\input{./Chapters/HeapExploiting/Unlink/practical_exploitation.tex}

\pagebreak

\input{./Chapters/HeapExploiting/Unlink/evolucion_tecnica.tex}